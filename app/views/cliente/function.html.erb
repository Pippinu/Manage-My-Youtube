<!DOCTYPE html>
<html amp >
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1">
    <link rel="shortcut icon" href="" type="">
  
    <title>ManageMyYoutube</title>
  
    <link rel="canonical" href="bookstore.html">
    <style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style>
    <noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="old stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css" rel="old stylesheet"><link href="https://fonts.googleapis.com/css?family=Barlow+Semi+Condensed:100,100i,200,200i,300,300i,400,400i,500,500i,600,600i,700,700i,800,800i,900,900i" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Heebo:100,300,400,500,700,800,900" rel="stylesheet">

    <script async  src="https://cdn.ampproject.org/v0.js"></script>
    <script async custom-element="amp-sidebar" src="https://cdn.ampproject.org/v0/amp-sidebar-0.1.js"></script>
    <script async custom-template="amp-mustache" src="https://cdn.ampproject.org/v0/amp-mustache-0.2.js"></script>
    <script async custom-element="amp-form" src="https://cdn.ampproject.org/v0/amp-form-0.1.js"></script>
    <script async custom-element="amp-lightbox" src="https://cdn.ampproject.org/v0/amp-lightbox-0.1.js"></script>
    <script async custom-element="amp-bind" src="https://cdn.ampproject.org/v0/amp-bind-0.1.js"></script>
    <script async custom-element="amp-lightbox-gallery" src="https://cdn.ampproject.org/v0/amp-lightbox-gallery-0.1.js"></script>
    <script async custom-element="amp-iframe" src="https://cdn.ampproject.org/v0/amp-iframe-0.1.js"></script>
    <script async custom-element="amp-analytics" src="https://cdn.ampproject.org/v0/amp-analytics-0.1.js"></script>
    
    
    
</head>
<body>

<section class="cid-rslFJC9ynI" id="menu01-4n">
	
	<!-- mine-navbar -->
	<nav class="mine-navbar mine-navbar-dropdown mine-navbar-expand-lg mine-navbar-fixed-top">
		<div class="menu-mine-container mine-container-fluid">
			
			<div class="mine-navbar-brand">
				<div class="mine-navbar-logo">
					<img src="/assets/local/logomyytmanager.png" style="width:80px;padding-right:10px">
				</div>
				<span class="mine-navbar-caption-wrap"><a class="mine-navbar-caption mbr-semibold text-black text-decoration-none display-5" style="font-size: 2rem" href="/">ManageMyYoutube</a></span>
			</div>

            <div class="mine-btns">
                <% if current_user %>
                    <div class="mine-navbar-buttons mbr-section-mine-btn d-flex">
                        <a class="mine-btn mine-btn-md mine-btn-black mbr-semibold display-7 text-decoration-none" href="/profile">Profile</a>
                    </div>
                    <div class="mine-navbar-buttons mbr-section-mine-btn d-flex">
                        <%= button_to "Logout", destroy_user_session_path, data: {turbo: "false"}, method: :delete, class:"mine-btnlogout" %>
                    </div>
                
                <% else%>
                <div class="mine-navbar-buttons mbr-section-mine-btn d-flex">
                
                    <a class="mine-btn mine-btn-md mine-btn-white mbr-semibold display-7" href="users/sign_in">Login</a>
                    <%= link_to "Login", new_user_session_path %>
                    
                </div>
                <div class="mine-navbar-buttons mbr-section-mine-btn d-flex">
                    <a class="mine-btn mine-btn-md mine-btn-black mbr-semibold display-7" href="users/sign_up">Sign Up</a>
                </div>
                <%end %>
            </div>

		</div>
	</nav>

	
	<!-- </div> -->
</section>

<section class="header3 cid-rsq6I1iuyl">
    <%def withoutLast5(user)
        if current_user.avatar_url
          return current_user.avatar_url[0..-6]+"s580-c"
        else 
          return "https://blogtimenow.com/wp-content/uploads/2014/06/hide-facebook-profile-picture-notification.jpg"
        end
      end    
    %>

    <% item= JSON.parse(@mineresponse).fetch("items")[0] %>

    <% snippet = item.fetch("snippet") %>
    <% statistics = item.fetch("statistics")%>

    <div class="container d-flex flex-row" style="min-height:270px">
        <div class="d-flex flex-column align-items-center col-6" >
            <h2 class="pt-3">Informazioni</h2>
            <div class="pt-3 pb-2">
                <% if !current_user.avatar.attached?%>
                <img src="<%=withoutLast5(current_user.avatar_url)%>" alt="avatar"
                class="rounded-circle border border-3 border-dark" style="width: 150px;">
                <% else %>
                <%= image_tag current_user.avatar,class:"rounded-circle border border-3 border-dark",height:150,width:150 %>
                <%end%>

            </div>

            <div class="d-flex pt-4">
                <h4 class="text-decoration-underline"><%= snippet.fetch("title")%></h4>
            </div>

            <div class="d-flex flex-row gap-5 px-2">
                <div class="pt-3 d-flex flex-column align-items-start">
                    <div class="py-2">
                        <h5>Iscritti:</h5>    
                        <span><%= statistics.fetch("subscriberCount")%></span> 
                    </div>
                    <div class="py-2">

                        <h5>Creato il:  </h5>
                        <span><%= snippet.fetch("publishedAt")[0..9]%></span> 
                    </div>
                </div>

                <div class="pt-3 d-flex flex-column align-items-start">
                    <div class="py-2">

                        <h5>Video Caricati:</h5>
                        <span><%= statistics.fetch("videoCount")%></span> 
                    </div>
                    <div class="py-2">

                        <h5>Visualizzazioni</h5>
                        <span><%= statistics.fetch("viewCount")%></span> 
                    </div>
                </div>
            </div>

        </div>
        <div class="d-flex flex-column col-6">
            <h2 class="pt-3">Funzioni Cliente</h2>

            <!--DA IMPLEMENTARE ! -->

            <div class="pt-4 d-flex flex-column gap-2">

                <a href = "/provayt1" class="link-secondary" >Informazioni Canale</a>
                <a class="link-secondary">Modifica Watermark</a>
                <a class="link-secondary">Modifica Banner Canale</a>
                <a class="link-secondary">Modifica Descrizione Canale</a>
                <a class="link-secondary">Carica un video</a>
                <a class="link-secondary">Lista dei video</a>
                <br>

                <% affilRecord = Affiliation.find_by(cliente: current_user.id, status: "accepted")%>
                <% if affilRecord %>
                    <%managerID = affilRecord.manager %>
                <% end%>
                <ul class="list-group">

                    <%if !Calendar.where(userId: current_user.id.to_s).where(managerId: managerID).take%>
                        <% if affilRecord %>
                            <li class="text-danger">Il tuo manager non ha ancora creato un Calendar !</li>
                        <% end%>
                    <%else%>
                    <div class="d-flex flex-row gap-3 align-items-center">
                        <div>
                            <%= link_to 'http://calendar.google.com/', target: :_blank do %>
                                <li class="btn btn-warning mt-1" style="width:100%">Visualizza Calendario</li>
                            <% end %>
                            <br>
                            <hr>
                            
                            <%= link_to calendar_createEvent_path(managerID: managerID) do %>
                                <li class="btn btnevent mt-1" style="width:100%; background-color: rgb(169, 249, 255);">Crea Evento</li>
                            <% end %>
                                <a href="/cliente/events" class="btn btnevent mt-1" style="width:100%;  background-color: rgb(98, 245, 255)">Visualizza Eventi</a>
                        </div>
                    </div>
                    <%end%>
                </ul>
                <!--
                <%= link_to 'Crea Evento', calendar_createEvent_path(managerID: managerID) %>
                <%= link_to 'Modifica Evento', calendar_listEvent_path(managerID: managerID) %>
                <%= link_to 'Elimina Evento', calendar_deleteEvent_path(managerID: managerID) %>
                -->
            </div>

        </div>
    </div>

</section>

